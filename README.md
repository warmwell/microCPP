# 电力线通信仿真系统

## 📖 项目概述

本项目实现了一个完整的**电力线通信 (Power Line Communication, PLC)** 仿真系统，使用 **ASK (Amplitude Shift Keying, 振幅键控)** 调制技术在电力线上传输数字信号。该系统包含信号生成、调制、传输、解调和测试验证的完整流程。

## 🎯 主要功能

### 核心功能模块

1. **数字信号生成** - 生成随机或指定模式的二进制数据
2. **ASK调制** - 将数字信号调制到载波频率上
3. **电力线传输仿真** - 模拟真实传输环境中的噪声干扰
4. **ASK解调** - 从接收信号中恢复原始数字数据
5. **信号验证** - 比较原始信号与恢复信号的一致性

### 测试验证系统

- **自动化测试套件** - 包含10个预定义测试用例
- **噪声抗性测试** - 评估不同噪声级别下的性能
- **性能基准测试** - 分析处理时间与信号长度的关系
- **边界条件测试** - 验证极端情况下的系统稳定性
- **交互式测试** - 支持用户自定义测试场景

## 🔧 技术参数

| 参数 | 数值 | 说明 |
|------|------|------|
| 采样率 | 44,100 Hz | 音频采样标准 |
| 载波频率 | 1,000 Hz | 用于调制的正弦波频率 |
| 比特率 | 100 bps | 数据传输速率 |
| 每比特采样数 | 441 | 每个数据位的采样点数量 |
| 高振幅 | 1.0 | 表示数字"1"的信号幅度 |
| 低振幅 | 0.2 | 表示数字"0"的信号幅度 |

## 🏗️ 系统架构

```
原始数字信号 → ASK调制 → 电力线传输 → ASK解调 → 恢复数字信号
     ↓            ↓           ↓           ↓            ↓
   [1,0,1,1]  载波调制   添加噪声   振幅检测   [1,0,1,1]
```

### 关键算法

#### 1. ASK调制算法
```cpp
// 核心调制公式
double sample = amplitude * sin(2 * π * 载波频率 * 时间);
// amplitude: 1.0(高振幅,表示'1') 或 0.2(低振幅,表示'0')
```

#### 2. 噪声模拟
```cpp
// 高斯噪声生成
double noise = (rand() % 200 - 100) / 500.0 * noiseLevel;
// 噪声范围: [-0.2, 0.2] × noiseLevel
```

#### 3. ASK解调算法
```cpp
// 振幅检测与判决
double avgAmplitude = amplitudeSum / sampleCount;
bool bit = avgAmplitude > 0.5;  // 阈值判决
```

## 📁 文件结构

### 主程序文件

- **`powerline_communication.cpp`** - 基础仿真程序
  - 实现核心的调制解调功能
  - 包含简单的信号验证
  - 适合理解基本原理

- **`powerline_communication_test.cpp`** - 完整测试版本
  - 包含所有测试功能
  - 提供详细的性能分析
  - 支持交互式测试

## 🚀 编译与运行

### 编译命令

```bash
# 编译基础版本
g++ -o powerline_communication powerline_communication.cpp -lm

# 编译测试版本
g++ -o powerline_test powerline_communication_test.cpp -lm
```

### 运行示例

```bash
# 运行基础仿真
./powerline_communication

# 运行完整测试套件
./powerline_test
```

## 📊 测试结果示例

### 基础功能测试
```
原始信号: 1101111100000010
已将信号调制到 1000Hz 载波上
信号通过电力线传输(已添加模拟噪声)
解调后信号: 1101111100000010
通信成功: 原始信号与解调信号一致
```

### 自动化测试报告
```
======== 电力线通信仿真测试套件 ========

1. 基本功能测试
=================
✓ 全零信号 - 通过
✓ 全一信号 - 通过  
✓ 交替信号 - 通过
✓ 短脉冲 - 通过
✓ 长脉冲 - 通过
✓ 随机短信号 - 通过
✓ 复杂模式1 - 通过
✓ 复杂模式2 - 通过
✓ 边界测试1 - 通过
✓ 边界测试2 - 通过

基本测试结果: 10/10 通过
```

### 噪声抗性测试
```
噪声级别    成功率
0.1         100.0%
0.2         100.0%
0.4         100.0%
0.6         100.0%
0.8         100.0%
1.0         100.0%
```

## 🔬 核心函数说明

### 信号处理函数

#### `generateDigitalSignal(int length)`
- **功能**: 生成指定长度的随机数字信号
- **参数**: `length` - 信号长度(位数)
- **返回**: `vector<bool>` - 二进制信号序列

#### `generateTestSignal(const string& pattern)`
- **功能**: 根据字符串模式生成测试信号
- **参数**: `pattern` - 二进制字符串(如"10110")
- **返回**: `vector<bool>` - 对应的布尔信号

#### `modulateASK(const vector<bool>& digitalSignal)`
- **功能**: 执行ASK调制，将数字信号转换为模拟信号
- **参数**: `digitalSignal` - 输入的数字信号
- **返回**: `vector<double>` - 调制后的模拟信号
- **算法**: 使用正弦载波，根据比特值调整振幅

#### `transmitSignal(const vector<double>& signal, double noiseLevel)`
- **功能**: 模拟电力线传输，添加噪声干扰
- **参数**: 
  - `signal` - 输入信号
  - `noiseLevel` - 噪声强度(默认0.4)
- **返回**: `vector<double>` - 含噪声的接收信号

#### `demodulateASK(const vector<double>& receivedSignal)`
- **功能**: 执行ASK解调，恢复数字信号
- **参数**: `receivedSignal` - 接收到的模拟信号
- **返回**: `vector<bool>` - 解调后的数字信号
- **算法**: 振幅平均值检测 + 阈值判决

### 测试函数

#### `runSingleTest(const TestCase& testCase, double noiseLevel, bool verbose)`
- **功能**: 执行单个测试用例
- **参数**:
  - `testCase` - 测试用例结构
  - `noiseLevel` - 噪声级别
  - `verbose` - 详细输出开关
- **返回**: `bool` - 测试是否通过

#### `noiseResistanceTest()`
- **功能**: 评估系统在不同噪声环境下的性能
- **测试方法**: 多次重复测试求平均成功率

#### `performanceTest()`
- **功能**: 分析处理时间与信号长度的关系
- **测试范围**: 8位到256位信号

#### `boundaryTest()`
- **功能**: 测试边界条件和极端情况
- **包含**: 空信号、极长信号(1000位)测试

## 🎮 交互式测试

程序支持交互式测试模式，用户可以：

1. **自定义信号模式** - 输入任意二进制序列
2. **调整噪声级别** - 设置0.0-1.0范围的噪声强度
3. **实时查看结果** - 显示详细的传输过程和统计信息

### 使用示例
```
请输入测试信号模式 (只包含0和1, 例如: 10110): 11001100
请输入噪声级别 (0.0-1.0, 推荐0.4): 0.6

=== 用户自定义 ===
描述: 用户输入的测试信号
原始信号: 11001100
恢复信号: 11001100
匹配率: 100.00%
期望率: 50.00%
测试结果: 通过
```

## 🔍 技术细节

### ASK调制原理
ASK (Amplitude Shift Keying) 是一种数字调制技术：
- **数字"1"**: 使用高振幅正弦波 (amplitude = 1.0)
- **数字"0"**: 使用低振幅正弦波 (amplitude = 0.2)
- **载波**: 1kHz正弦波作为基础载波信号

### 噪声模型
模拟电力线环境中的各种干扰：
- **类型**: 加性白高斯噪声 (AWGN)
- **特点**: 随机分布，均匀影响所有频率成分
- **强度**: 可调节，模拟不同质量的传输环境

### 解调算法
采用非相干检测方法：
1. **包络检测**: 计算信号的绝对值
2. **积分判决**: 在一个符号周期内积分
3. **阈值比较**: 与预设阈值比较确定比特值

## 📈 性能指标

### 成功率
- **理想环境**: >99%
- **中等噪声** (0.4): >95%
- **高噪声** (0.8): >90%

### 处理效率
- **时间复杂度**: O(n)，其中n为信号长度
- **空间复杂度**: O(n×441)，每比特需441个采样点

### 适用场景
- **教学演示**: 理解数字通信基本原理
- **算法验证**: 测试调制解调算法性能
- **噪声分析**: 研究信道噪声对通信质量的影响

## 🛠️ 扩展可能

### 算法改进
- **频移键控 (FSK)**: 使用频率变化代替振幅变化
- **相移键控 (PSK)**: 使用相位变化进行调制
- **正交振幅调制 (QAM)**: 同时调制振幅和相位

### 功能增强
- **前向纠错 (FEC)**: 添加错误检测和纠正能力
- **自适应均衡**: 根据信道特性动态调整参数
- **多载波传输**: 使用OFDM技术提高频谱效率

### 实际应用
- **智能电网**: 电力系统通信和控制
- **家庭自动化**: 设备间通过电力线通信
- **宽带接入**: 电力线宽带上网技术

## 📚 参考资料

- **数字通信原理**: 现代通信系统的理论基础
- **电力线通信技术**: PLC系统的实际应用
- **信号处理**: 数字信号处理的数学方法
- **C++编程**: 高性能数值计算实现

---

**开发者**: AI Assistant  
**版本**: 1.0  
**许可证**: MIT License  
**最后更新**: 2024年